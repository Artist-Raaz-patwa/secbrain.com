<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Second Brain</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- jsPDF Library for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, connectFirestoreEmulator } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, connectAuthEmulator } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDyYqoNx8b3RX6CbEBGoHZl49CCcQZifXQ",
            authDomain: "secbrain-21463.firebaseapp.com",
            projectId: "secbrain-21463",
            storageBucket: "secbrain-21463.firebasestorage.app",
            messagingSenderId: "691316416239",
            appId: "1:691316416239:web:8a9d18fb2b3fb1ce08451a",
            measurementId: "G-WQDYEJZF2Y"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const analytics = getAnalytics(app);
        
        // Make Firebase available globally
        window.firebase = { app, db, auth, analytics };
        
        // For development - uncomment these lines to use Firebase emulators
        // connectFirestoreEmulator(db, 'localhost', 8080);
        // connectAuthEmulator(auth, 'http://localhost:9099');
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                </button>
                <div class="app-title-section">
                    <h1 class="app-title">Second Brain</h1>
                    <span class="app-version">v1.0</span>
                </div>
                <div class="header-actions">
                    <div class="server-indicator-container">
                        <div class="server-indicator" id="serverIndicator" title="Server Status">
                            <div class="indicator-dot"></div>
                            <div class="indicator-pulse"></div>
                        </div>
                    </div>
                    <button class="action-btn" id="manualSaveBtn" aria-label="Save Data" title="Save all data to cloud">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17,21 17,13 7,13 7,21"></polyline>
                            <polyline points="7,3 7,8 15,8"></polyline>
                        </svg>
                    </button>
                    <button class="action-btn" id="searchBtn" aria-label="Search">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                    <button class="action-btn" id="settingsBtn" aria-label="Settings">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <h3 class="nav-section-title">Modules</h3>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link active" data-module="dashboard">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="14" width="7" height="7"></rect>
                                    <rect x="3" y="14" width="7" height="7"></rect>
                                </svg>
                                Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="notes">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14,2 14,8 20,8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10,9 9,9 8,9"></polyline>
                                </svg>
                                Notes
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="tasks">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 11l3 3l8-8"></path>
                                    <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9s4.03-9 9-9c1.5 0 2.91.37 4.15 1.02"></path>
                                </svg>
                                Tasks
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="completed-tasks">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 12l2 2 4-4"></path>
                                    <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9s4.03-9 9-9c1.5 0 2.91.37 4.15 1.02"></path>
                                </svg>
                                Completed Tasks
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="bookmarks">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                                </svg>
                                Bookmarks
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="calendar">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                                Calendar
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="habits">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 12l2 2 4-4"></path>
                                    <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9s4.03-9 9-9c1.5 0 2.91.37 4.15 1.02"></path>
                                </svg>
                                Habits
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="crm">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                                    <path d="M12 11h4"></path>
                                    <path d="M12 16h4"></path>
                                    <path d="M8 11h.01"></path>
                                    <path d="M8 16h.01"></path>
                                </svg>
                                CRM
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="pomodoro">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12,6 12,12 16,14"></polyline>
                                </svg>
                                Pomodoro
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="auth">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                                Account
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="wallet">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                                    <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                                    <path d="M18 12a2 2 0 0 0 0 4h4v-4Z"></path>
                                </svg>
                                Wallet
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="goals">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                </svg>
                                Goals
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="settings">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>
                                </svg>
                                Settings
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="logs">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14,2 14,8 20,8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10,9 9,9 8,9"></polyline>
                                </svg>
                                Activity Log
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3 class="nav-section-title">Tools</h3>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="search">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <path d="m21 21-4.35-4.35"></path>
                                </svg>
                                Search
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-module="analytics">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M18 20V10"></path>
                                    <path d="M12 20V4"></path>
                                    <path d="M6 20v-6"></path>
                                </svg>
                                Analytics
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <div class="content-header">
                <h2 class="content-title">Dashboard</h2>
                <p class="content-subtitle">Welcome to your Second Brain</p>
            </div>
            
            <div class="content-body">
                <!-- Dashboard Header with Add Widget Button -->
                <div class="dashboard-header">
                    <div class="dashboard-header-content">
                        <div class="dashboard-title-section">
                            <h2 class="dashboard-title">My Dashboard</h2>
                            <p class="dashboard-subtitle">Customize your workspace with widgets from all modules</p>
                        </div>
                        <button class="add-widget-btn" id="addWidgetBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Add Widget
                        </button>
                    </div>
                </div>

                <!-- Dashboard Grid Container -->
                <div class="dashboard-widgets-container" id="dashboardWidgetsContainer">
                    <!-- Empty State -->
                    <div class="dashboard-empty-state" id="dashboardEmptyState">
                        <div class="empty-state-content">
                            <div class="empty-state-icon">
                                <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                                    <rect x="3" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="14" width="7" height="7"></rect>
                                    <rect x="3" y="14" width="7" height="7"></rect>
                                </svg>
                            </div>
                            <h3 class="empty-state-title">Your Dashboard is Empty</h3>
                            <p class="empty-state-description">Add widgets from your modules to create a personalized workspace that fits your workflow.</p>
                            <button class="btn btn-primary btn-large" id="addFirstWidgetBtn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Add Your First Widget
                            </button>
                        </div>
                    </div>

                    <!-- Widget Grid -->
                    <div class="widget-grid" id="widgetGrid" style="display: none;">
                        <!-- Widgets will be dynamically added here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Completed Tasks View -->
    <div class="completed-tasks-container" id="completedTasksView" style="display: none;">
        <div class="completed-tasks-header">
            <div class="completed-tasks-title-section">
                <h2 class="completed-tasks-title">Completed Tasks</h2>
                <p class="completed-tasks-subtitle">Review and select tasks for client reports</p>
            </div>
            <div class="completed-tasks-actions">
                <div class="selection-info">
                    <span id="selectedCount">0</span> of <span id="totalCount">0</span> tasks selected
                </div>
                <button class="btn btn-secondary" id="selectAllBtn">Select All</button>
                <button class="btn btn-secondary" id="clearSelectionBtn">Clear Selection</button>
                <button class="btn btn-primary" id="generateReportBtn" disabled>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14,2 14,8 20,8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                    </svg>
                    Generate Report
                </button>
            </div>
        </div>

        <div class="completed-tasks-filters">
            <div class="filter-group">
                <label for="projectFilter">Project:</label>
                <select id="projectFilter" class="filter-select">
                    <option value="">All Projects</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="dateRangeStart">From Date:</label>
                <input type="date" id="dateRangeStart" class="filter-input">
            </div>
            <div class="filter-group">
                <label for="dateRangeEnd">To Date:</label>
                <input type="date" id="dateRangeEnd" class="filter-input">
            </div>
            <div class="filter-group">
                <label for="searchTasks">Search:</label>
                <input type="text" id="searchTasks" class="filter-input" placeholder="Search tasks...">
            </div>
            <div class="filter-group">
                <button class="btn btn-secondary" id="clearFiltersBtn">Clear Filters</button>
            </div>
        </div>

        <div class="completed-tasks-stats">
            <div class="stat-card">
                <div class="stat-number" id="totalCompletedTasks">0</div>
                <div class="stat-label">Total Completed</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalHoursSpent">0h</div>
                <div class="stat-label">Hours Spent</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalValue">â‚¹0</div>
                <div class="stat-label">Total Value</div>
            </div>
        </div>

        <!-- Productivity Calendar Section -->
        <div class="productivity-calendar-section">
            <div class="productivity-calendar-header">
                <h3 class="productivity-calendar-title">Productivity Calendar</h3>
                <div class="view-toggle">
                    <button class="view-toggle-btn active" id="listViewBtn" data-view="list">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="8" y1="6" x2="21" y2="6"></line>
                            <line x1="8" y1="12" x2="21" y2="12"></line>
                            <line x1="8" y1="18" x2="21" y2="18"></line>
                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                        </svg>
                        List View
                    </button>
                    <button class="view-toggle-btn" id="calendarViewBtn" data-view="calendar">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        Calendar View
                    </button>
                </div>
            </div>

            <!-- Calendar View -->
            <div class="productivity-calendar-container" id="productivityCalendarContainer" style="display: none;">
                <div class="calendar-header">
                    <button class="calendar-nav-btn" id="prevMonthProductivity">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15,18 9,12 15,6"></polyline>
                        </svg>
                    </button>
                    <h2 class="calendar-month-year" id="productivityCalendarMonthYear">January 2024</h2>
                    <button class="calendar-nav-btn" id="nextMonthProductivity">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9,18 15,12 9,6"></polyline>
                        </svg>
                    </button>
                </div>

                <div class="calendar-grid">
                    <div class="calendar-weekdays">
                        <div class="calendar-weekday">Sun</div>
                        <div class="calendar-weekday">Mon</div>
                        <div class="calendar-weekday">Tue</div>
                        <div class="calendar-weekday">Wed</div>
                        <div class="calendar-weekday">Thu</div>
                        <div class="calendar-weekday">Fri</div>
                        <div class="calendar-weekday">Sat</div>
                    </div>
                    <div class="calendar-days" id="productivityCalendarDays">
                        <!-- Calendar days will be rendered here -->
                    </div>
                </div>

                <div class="productivity-legend">
                    <div class="legend-title">Productivity Scale</div>
                    <div class="legend-items">
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #000000; border: 1px solid #333333;"></div>
                            <span>0-25%</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #374151; border: 1px solid #4b5563;"></div>
                            <span>26-50%</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #6b7280; border: 1px solid #9ca3af;"></div>
                            <span>51-75%</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #9ca3af; border: 1px solid #d1d5db;"></div>
                            <span>76-100%</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color legend-100-plus" style="background-color: #d1d5db; border: 2px solid #ffffff;"></div>
                            <span>100%+</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="completed-tasks-list" id="completedTasksList">
            <!-- Completed tasks will be rendered here -->
        </div>

        <div class="empty-state" id="emptyCompletedTasks" style="display: none;">
            <div class="empty-state-icon">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                    <path d="M9 12l2 2 4-4"></path>
                    <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9s4.03-9 9-9c1.5 0 2.91.37 4.15 1.02"></path>
                </svg>
            </div>
            <h3>No Completed Tasks</h3>
            <p>Complete some tasks to see them here and generate client reports.</p>
        </div>
    </div>

        <!-- Authentication Modal (for future use) -->
        <div class="auth-modal" id="authModal" style="display: none;">
            <div class="auth-modal-content">
                <div class="auth-modal-header">
                    <h3 id="authModalTitle">Sign In</h3>
                    <button class="auth-modal-close" id="authModalClose">&times;</button>
                </div>
                <div class="auth-modal-body">
                    <form id="authForm">
                        <div class="auth-form-group">
                            <label for="authEmail">Email:</label>
                            <input type="email" id="authEmail" class="form-input" required>
                        </div>
                        <div class="auth-form-group">
                            <label for="authPassword">Password:</label>
                            <input type="password" id="authPassword" class="form-input" required>
                        </div>
                        <div class="auth-form-actions">
                            <button type="submit" class="btn btn-primary" id="authSubmitBtn">Sign In</button>
                            <button type="button" class="btn btn-secondary" id="authSwitchBtn">Create Account</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Task Completion Modal -->
        <div class="task-completion-modal" id="taskCompletionModal">
        <div class="task-completion-modal-content">
            <div class="task-completion-modal-header">
                <h3 class="task-completion-modal-title">Task Completed!</h3>
                <button class="task-completion-modal-close" id="taskCompletionModalClose">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="task-completion-modal-body">
                <div class="task-completion-info">
                    <p class="task-completion-message">Great job completing this task! Please provide some details:</p>
                    <div class="task-name-display" id="completedTaskName"></div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="hoursSpent">Hours Spent *</label>
                    <input type="number" id="hoursSpent" class="form-input" min="0" step="0.25" placeholder="e.g., 2.5" required>
                    <small class="form-hint">Enter the number of hours you spent on this task</small>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="completionNote">Completion Note (Optional)</label>
                    <textarea id="completionNote" class="form-textarea" rows="3" placeholder="Add any notes about how the task went, what you learned, or any challenges you faced..."></textarea>
                </div>
            </div>
            <div class="task-completion-modal-actions">
                <button class="btn btn-secondary" id="cancelTaskCompletion">Cancel</button>
                <button class="btn btn-primary" id="confirmTaskCompletion">Mark Complete</button>
            </div>
        </div>
    </div>

    <!-- Edit Completion Date Modal -->
    <div class="edit-completion-date-modal" id="editCompletionDateModal">
        <div class="edit-completion-date-modal-content">
            <div class="edit-completion-date-modal-header">
                <h3 class="edit-completion-date-modal-title">Edit Completion Date</h3>
                <button class="edit-completion-date-modal-close" id="editCompletionDateModalClose">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="edit-completion-date-modal-body">
                <div class="edit-completion-date-info">
                    <p class="edit-completion-date-message">Update the completion date and time for this task:</p>
                    <div class="task-name-display" id="editCompletionTaskName"></div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="editCompletionDate">Completion Date *</label>
                    <input type="date" id="editCompletionDate" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="editCompletionTime">Completion Time *</label>
                    <input type="time" id="editCompletionTime" class="form-input" required>
                </div>
            </div>
            <div class="edit-completion-date-modal-actions">
                <button class="btn btn-secondary" id="cancelEditCompletionDate">Cancel</button>
                <button class="btn btn-primary" id="saveEditCompletionDate">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Daily Productivity Modal -->
    <div class="daily-productivity-modal" id="dailyProductivityModal">
        <div class="daily-productivity-modal-content">
            <div class="daily-productivity-modal-header">
                <h3 class="daily-productivity-modal-title">Daily Productivity</h3>
                <button class="daily-productivity-modal-close" id="dailyProductivityModalClose">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="daily-productivity-modal-body">
                <div class="daily-productivity-info">
                    <div class="productivity-date" id="productivityModalDate"></div>
                    <div class="productivity-summary">
                        <div class="productivity-metric">
                            <div class="metric-value" id="productivityPercentage">0%</div>
                            <div class="metric-label">Productivity</div>
                        </div>
                        <div class="productivity-metric">
                            <div class="metric-value" id="totalHoursWorked">0h</div>
                            <div class="metric-label">Hours Worked</div>
                        </div>
                        <div class="productivity-metric">
                            <div class="metric-value" id="tasksCompleted">0</div>
                            <div class="metric-label">Tasks Completed</div>
                        </div>
                    </div>
                </div>
                
                <div class="completed-tasks-for-day" id="completedTasksForDay">
                    <!-- Tasks completed on this day will be listed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Widget Selection Modal -->
    <div class="widget-selection-modal" id="widgetSelectionModal">
        <div class="widget-selection-modal-content">
            <div class="widget-selection-modal-header">
                <h3 class="widget-selection-modal-title">Add Widget to Dashboard</h3>
                <button class="widget-selection-modal-close" id="widgetSelectionModalClose">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="widget-selection-modal-body">
                <div class="widget-categories">
                    <!-- Notes Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14,2 14,8 20,8"></polyline>
                            </svg>
                            Notes
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="notes-recent">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                        <polyline points="14,2 14,8 20,8"></polyline>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Recent Notes</h5>
                                    <p>Show your latest notes with quick access</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="notes-stats">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 20V10"></path>
                                        <path d="M12 20V4"></path>
                                        <path d="M6 20v-6"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Notes Statistics</h5>
                                    <p>Total notes count and growth metrics</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tasks Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 11l3 3l8-8"></path>
                                <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9s4.03-9 9-9c1.5 0 2.91.37 4.15 1.02"></path>
                            </svg>
                            Tasks
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="tasks-today">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12,6 12,12 16,14"></polyline>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Today's Tasks</h5>
                                    <p>Tasks due today with progress tracking</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="tasks-overdue">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <path d="M12 6v6l4 2"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Overdue Tasks</h5>
                                    <p>Tasks that need immediate attention</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="tasks-completed">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 12l2 2 4-4"></path>
                                        <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9s4.03-9 9-9c1.5 0 2.91.37 4.15 1.02"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Completed Tasks</h5>
                                    <p>Recently completed tasks and productivity</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Calendar Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            Calendar
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="calendar-mini">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                        <line x1="16" y1="2" x2="16" y2="6"></line>
                                        <line x1="8" y1="2" x2="8" y2="6"></line>
                                        <line x1="3" y1="10" x2="21" y2="10"></line>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Mini Calendar</h5>
                                    <p>Compact calendar view with events</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="calendar-upcoming">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12,6 12,12 16,14"></polyline>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Upcoming Events</h5>
                                    <p>Next few events and appointments</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Habits Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 12l2 2 4-4"></path>
                                <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9s4.03-9 9-9c1.5 0 2.91.37 4.15 1.02"></path>
                            </svg>
                            Habits
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="habits-streak">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Habit Streaks</h5>
                                    <p>Track your daily habit streaks</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Wallet Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                                <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                                <path d="M18 12a2 2 0 0 0 0 4h4v-4Z"></path>
                            </svg>
                            Wallet
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="wallet-balance">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                                        <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                                        <path d="M18 12a2 2 0 0 0 0 4h4v-4Z"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Wallet Balance</h5>
                                    <p>Current balance and quick transaction access</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="wallet-transactions">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                        <polyline points="14,2 14,8 20,8"></polyline>
                                        <line x1="16" y1="13" x2="8" y2="13"></line>
                                        <line x1="16" y1="17" x2="8" y2="17"></line>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Recent Transactions</h5>
                                    <p>Latest income and expense entries</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="wallet-summary">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 20V10"></path>
                                        <path d="M12 20V4"></path>
                                        <path d="M6 20v-6"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Income vs Expense</h5>
                                    <p>Monthly financial overview and trends</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Goals Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                            </svg>
                            Goals
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="goals-progress">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <path d="M12 6v6l4 2"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Goal Progress</h5>
                                    <p>Track progress towards your active goals</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="goals-achievements">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Recent Achievements</h5>
                                    <p>Celebrate your completed goals and milestones</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- CRM Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                                <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                            </svg>
                            CRM
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="crm-projects">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                                        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Active Projects</h5>
                                    <p>Current projects and their status</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="crm-revenue">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Revenue Tracker</h5>
                                    <p>Monthly earnings and client payments</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Productivity Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12,6 12,12 16,14"></polyline>
                            </svg>
                            Productivity
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="pomodoro-timer">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12,6 12,12 16,14"></polyline>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Pomodoro Timer</h5>
                                    <p>Quick access to focus sessions</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="daily-summary">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 20V10"></path>
                                        <path d="M12 20V4"></path>
                                        <path d="M6 20v-6"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Daily Summary</h5>
                                    <p>Today's productivity overview</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="focus-time">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <path d="M12 6v6l4 2"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Focus Time</h5>
                                    <p>Track your deep work sessions</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Access Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                            </svg>
                            Quick Access
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="quick-notes">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                        <polyline points="14,2 14,8 20,8"></polyline>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Quick Notes</h5>
                                    <p>Fast note-taking and capture ideas</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="time-weather">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12,6 12,12 16,14"></polyline>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Time & Weather</h5>
                                    <p>Current time and weather information</p>
                                </div>
                            </div>
                            <div class="widget-option" data-widget="bookmark-shortcuts">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Bookmark Shortcuts</h5>
                                    <p>Quick access to your favorite bookmarks</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Widgets -->
                    <div class="widget-category">
                        <h4 class="widget-category-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 20V10"></path>
                                <path d="M12 20V4"></path>
                                <path d="M6 20v-6"></path>
                            </svg>
                            Analytics
                        </h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget="analytics-productivity">
                                <div class="widget-option-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 20V10"></path>
                                        <path d="M12 20V4"></path>
                                        <path d="M6 20v-6"></path>
                                    </svg>
                                </div>
                                <div class="widget-option-content">
                                    <h5>Productivity Chart</h5>
                                    <p>Visual productivity trends and insights</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="widget-selection-modal-actions">
                <button class="btn btn-secondary" id="cancelWidgetSelection">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
